---

# Резюме проекта Dzengi API Integration

## Краткое описание
Веб-приложение на Spring MVC, интегрируется с демонстрационной площадкой Dzengi (Binance-like API). Позволяет просматривать информацию о счёте и рынке, размещать ордера, получать в реальном времени котировки.

---

## Стек технологий

- **Java 17+**
- **Spring MVC** + **Spring Boot (опционально)**
- **Spring Websocket**
- **Gson** (работа с JSON)
- **Servlet API + Tomcat**
- **JSP** как движок view
- **JS/jQuery** для UI (минимальное использование)
- **Maven** (или Gradle) для сборки
- **Logging**: SLF4J + Logback

---

## Архитектура и структура

### 1. Application Configuration
- `application.properties` — все параметры API, подключения и настройки приложения (ключи, таймауты, URL).
- `WebConfig.java` — конфигурация DispatcherServlet, разрешение JSP, настройка websocket-endpoints.

### 2. Основные компоненты

**Контроллеры (`controller`)**  
Обеспечивают веб-интерфейс (HTML формы + REST endpoint), взаимодействуют с сервисом.  
Примеры:  
∙ `/account` — информация о счёте  
∙ `/ticker` — просмотр цены инструмента  
∙ `/order` — размещение ордера

**Сервисы (`service`)**  
Инкапсулируют логику работы с API Dzengi.  
- `DzengiApiService` (интерфейс),  
- `DzengiApiServiceImpl` (реализация)  
—— всё, что связано с подписанными запросами

**HTTP API клиент (`service.api.HttpApiClient`)**  
Низкоуровневая работа с HTTP  
Обеспечивает GET/POST + авторизацию + таймауты + возврат JSON

**Обработчик API-ответов (`service.handler.ApiResponseHandler`)**  
Преобразует ответы API в нормализованный вид, обрабатывает ошибки

**Работа с инструментами/символами (`service.SymbolService`)**  
Кэширует список торговых пар (обновляемый)

**WebSocket обработчик (`websocket.handler.RealtimeTickerHandler`)**  
Обслуживает push-обновления

**Планировщик котировок (`websocket.scheduler.TickerUpdater`)**  
Планирует фоновую отправку обновлений подписанным сессиям

---

## Безопасность и конфигурация ключей

- Доступ к API осуществляется с API Key & Secret, которые хранятся **только в `application.properties`**.
- На UI эти ключи не вводятся (устранение фактора человеческих ошибок).
- Все подписанные запросы – с обязательной подписью HMAC-SHA256.

---

## Типовой поток работы

1. Пользователь выбирает инструмент или жмёт "Разместить ордер".
2. Контроллер получает форму, данные, передаёт их в сервис.
3. DZengi API сервис готовит параметры, подписывает, вызывает удалённый API.
4. Ответ API нормализуется, контроллер показывает результат.
5. Для получения в реальном времени цен — websocket подписка, постоянное обновление.

---

## Стратегии расширения

- **Поддержка новых API Dzengi**: расширение DzengiApiService + новый контроллер + JSP.
- **Аутентификация/Авторизация**: легко интегрировать Spring Security, если понадобится.
- **Docker/K8s**: легко контейнеризовать (если добавить Spring Boot стартер).
- **Интеграция с СУБД**: возможность логировать операции.
- **REST API**: можно выложить REST endpoint поверх текущих контроллеров для интеграции с фронтендом.
- **Настройка Deployment**: настройка CI/CD для быстрой поставки.
- **Фронтенд SPA**: можно заменить JSP на React/Angular и использовать REST + websocket.

---

## Особенности

- Используется **"thin controller, fat service"** подход (контроллеры — минимум логики).
- Поддерживается **централизованная обработка ошибок и успешных ответов**.
- **Весь API-интерфейс с подписью** — обеспечена безопасность.
- **Websocket обновления** — клиент получает свежие данные без опросов.
- **Кэширование данных** (например, символов).
- Основная логика находится в сервисах, легко расширяется/тестируется.

---

## Важные моменты для новых разработчиков

- Основной API-ключ НЕ должен храниться/передаваться в UI.
- Все интеграции c API – через сервисы.
- Для безопасной работы с API используйте секрет и ключ только в серверной части.
- Чтобы добавить API, копируйте уже существующие шаблоны.
- Для изменений UI — работайте с JSP и имеющимися контроллерами.
- Запускать можно как обычный WAR-файл или через embedded Tomcat (если Spring Boot).

---

## Ключевые классы и их назначение

|Класс|Назначение|
|---|---|
|`DzengiApiServiceImpl`| Вся деловая логика запросов к API|
|`HttpApiClient`| Низкоуровневый HTTP клиент|
|`ApiResponseHandler`| Унификация ошибок API|
|`OrderController` и др.| Обработка запросов юзера|
|`RealtimeTickerHandler`| Организация Websocket подписок|
|`TickerUpdater`| Планирование и отправка котировок|
|`SignatureUtil`| Подпись запросов (HMAC SHA256)|
|`application.properties`| Настройки подключения и ключей|

---

## Заключение
Этот проект — модульное, легко расширяемое Java Spring приложение для работы с API Dzengi. Чёткое разделение слоёв облегчает сопровождение и развитие. Новому сотруднику для начала рекомендуется изучить цепочку вызовов: контроллер → сервис → http client → response handler и ознакомиться с настройками API в `application.properties`.

---
Этот проект — модульное, легко расширяемое Java Spring приложение для работы с API Dzengi. Чёткое разделение слоёв облегчает сопровождение и развитие. Новому сотруднику для начала рекомендуется изучить цепочку вызовов: контроллер → сервис → http client → response handler и ознакомиться с настройками API в application.properties.
